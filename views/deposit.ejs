<div class="container">
    <h1>Депозит</h1>

    <% if (currentUser) { %>
        <p>Баланс: $<%= currentUser.balance.toFixed(2) %></p>
        <p>Нажмите кнопку START внизу для запуска депозита.</p>
    <% } %>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const btn = document.getElementById('depositBtn');
    if (btn) {
        btn.addEventListener('click', async () => {
            try {
                const res = await fetch('/start-deposit', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ amount: 100 }) // фиксированная сумма или баланс
                });
                if (res.redirected) window.location.href = res.url;
            } catch (err) {
                alert('Ошибка сервера');
            }
        });
    }
});
</script>

<nav class="fixed-footer">
    <a href="/group">Моя группа</a>
    <a id="depositBtn" class="btn">START</a>
    <a href="/history">История</a>
</nav>